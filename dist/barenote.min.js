var Barenote=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports="<html> <head> <title>About</title> </head> <body style=text-align:center> <h1>Barenote</h1> version 0.3.0<br/> <a href=https://github.com/kokufu/Barenote target=_blank>https://github.com/kokufu/Barenote</a> </body> </html>"},function(e,t,n){"use strict";n.r(t);var o=Object.freeze({REF_CLASS:"barenote",get REF_SELECTOR(){return`.${this.REF_CLASS}`},REF_LIST_CLASS:"barenote_ref_list",get REF_LIST_SELECTOR(){return`.${this.REF_LIST_CLASS}`},FLOATING_NOTE_ID:"barenote_floating_note",get FLOATING_NOTE_SELECTOR(){return`#${this.FLOATING_NOTE_ID}`},ABOUT_INDICATOR_CLASS:"barenote_about_indicator",get ABOUT_INDICATOR_SELECTOR(){return`.${this.ABOUT_INDICATOR_CLASS}`},get DEFAULT_CSS(){return this.FLOATING_NOTE_SELECTOR+" {background-color: #eeeeee;padding: 0em 1em 0em 1em;border: solid 1px;font-size: 90%;font-family: Helvetica, Sans-serif;line-height: 1.4;-moz-border-radius: .5em;-webkit-border-radius: .5em;border-radius: .5em;opacity: 0.95;}"+this.REF_LIST_SELECTOR+" {position: relative !important;}"+this.ABOUT_INDICATOR_SELECTOR+" {position: absolute !important;right: 1px !important;top: 1px !important;cursor: pointer !important;background-color: #2196F3;color: #ffffff;width: 17px;height: 17px;line-height: 17px;font-size: 10px;text-align: center;margin: 0;padding: 0;}"}});function r(e){const t=`#${e}`;let n=document.querySelector(t);if(!n){(n=document.createElement("div")).setAttribute("id",e),n.style.cssText="position: absolute !important;",n.hidden=!0,document.body.appendChild(n);const t=n.style.opacity?n.style.opacity:1;n.show=e=>{const o=e.data.element.getBoundingClientRect();let r=o.left+o.width+window.pageXOffset;const i=o.top+o.height+window.pageYOffset;r+420>window.innerWidth&&(r=window.innerWidth-420),n.isAnimating=!1,n.innerHTML=e.data.text,n.style.left=`${r}px`,n.style.top=`${i}px`,n.style.opacity=t,n.hidden=!1},n.hide=()=>{const e=window.performance.now();n.isAnimating=!0,window.requestAnimationFrame((function o(r){if(!n.isAnimating)return;const i=r-e-500;if(i<0)return void window.requestAnimationFrame(o);let a=t*(1-i/1e3);a=a<0?0:a,n.style.opacity=a,i<1e3?window.requestAnimationFrame(o):(n.hidden=!0,n.isAnimating=!1)}))}}return n}function i(){const e=window.scrollX,t=window.scrollY,n=this.getBoundingClientRect().top+window.pageYOffset,o=window.performance.now();window.requestAnimationFrame((function r(i){let a=(i-o)/200;const s=t+(n-t)*(a=a>1?1:a);window.scrollTo(e,s),1!=a&&window.requestAnimationFrame(r)}))}class a{constructor(e,t,n){const a=`${e.objectNumber}_${t}`;Object.defineProperties(this,{index:{get:()=>t},reference:{get:()=>a},originalElement:{get:()=>n}});const s=function(e){const t=new r(o.FLOATING_NOTE_ID);let n=!1;const a=document.createElement("a");return a.innerText=`${e.index+1}`,a.setAttribute("id",`fnref:${e.reference}`),a.setAttribute("href",`#fn:${e.reference}`),a.setAttribute("class",o.REF_CLASS),a.addEventListener("touchstart",o=>{o.data={element:a,text:e.originalElement.innerHTML},t.show(o),n=!0}),a.addEventListener("touchend",e=>{t.hide(),setTimeout(()=>{n=!1},500)}),a.addEventListener("mouseover",o=>{n||(o.data={element:a,text:e.originalElement.innerHTML},t.show(o))}),a.addEventListener("mouseout",e=>{t.hide()}),a.addEventListener("click",t=>{n||e.listElement.scrollToOwnTop(),t.stopPropagation(),t.preventDefault()}),a.scrollToOwnTop=i,a}(this),l=function(e){const t=document.createElement("a");t.setAttribute("href",`#fnref:${e.reference}`),t.innerHTML="&#8617;",t.addEventListener("click",t=>{e.barenoteElement.scrollToOwnTop(),t.stopPropagation(),t.preventDefault()});const n=document.createElement("li");return n.setAttribute("id",`fn:${e.reference}`),n.innerHTML=`${e.originalElement.innerHTML}&nbsp;`,n.appendChild(t),n.scrollToOwnTop=i,n}(this);Object.defineProperties(this,{barenoteElement:{get:()=>s},listElement:{get:()=>l}})}}n.d(t,"Barenote",(function(){return c}));let s=!1;let l=0;class c{constructor(e){if("undefined"==typeof window||"undefined"==typeof document)throw new Error("Barenote requires a window with a document");!function(){if(s)return;const e=document.createElement("style");e.setAttribute("type","text/css"),e.innerText=o.DEFAULT_CSS;let t=document.getElementsByTagName("head")[0];t?t.insertBefore(e,t.firstChild):document.rootElement.insertBefore(e,document.rootElement.firstChild),s=!0}();const t=[],r=l;l++;const i=e.querySelector(o.REF_LIST_SELECTOR),c=document.createElement("ol");i&&(i.appendChild(c),function(e){const t=n(0),r=document.createElement("div");r.appendChild(document.createTextNode("?")),r.setAttribute("class",o.ABOUT_INDICATOR_CLASS),r.addEventListener("click",e=>{window.open("","","width=500, height=200").document.write(t),e.stopPropagation(),e.preventDefault()}),e.appendChild(r)}(i));for(const[n,r]of e.querySelectorAll(o.REF_SELECTOR).entries()){const e=new a(this,n,r);t.push(e)}this.enable=()=>{for(const e of t){const t=e.originalElement.parentElement;t&&(t.replaceChild(e.barenoteElement,e.originalElement),c.appendChild(e.listElement))}},this.disable=()=>{for(const e of t){const t=e.barenoteElement.parentElement;t&&(t.replaceChild(e.originalElement,e.barenoteElement),c.removeChild(e.listElement))}},Object.defineProperties(this,{rootElement:{get:()=>e},objectNumber:{get:()=>r}}),this.enable()}static apply(e){if(console.warn("Deprecation: Barenote.apply() has been deprecated. use `new Barenote(element)` instead."),e||(e=document.querySelector("body")),"function"==typeof e[Symbol.iterator]){var t=[];for(const n of e)t.push(new c(n));return t}return new c(e)}}}]).Barenote;